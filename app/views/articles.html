<div class='row'>
	<div class='col-md-12'>
		<h1 class='page-header'>Artigos</h1>
	</div>
</div>

<div class='row'>
	<div class='col-md-12'>
		<div class='panel panel-default'>
			<div class='panel-body'>
				<form >
					<div class='row'>
						<div class='col-md-3'>
							<div class='form-group'>
								<label>Pesquisar</label>
								<input ng-model='article.filter.value' placeholder='Pesquisar artigos' maxlength='255' class='form-control'>
							</div>
						</div>
						<div class='col-md-9'>
							<div class='form-group'>
								<label>&nbsp;</label>
								<div>
									<button class='btn btn-primary' ng-click='article.list(article.filter)'>
										<i class='fa fa-search'></i> Buscar
									</button>
									<a href class='btn btn-default' ng-click='article.toggleAdvancedSearch()'>
										<i class='fa fa-chevron-down' ng-show='!article.advancedSearch'></i> 
										<i class='fa fa-chevron-up' ng-show='article.advancedSearch'></i> 
										Busca Avançada
									</a>
								</div>
							</div>
						</div>
					</div>
					<div class='row' ng-show='article.advancedSearch'>
						<div class='col-md-3'>
							<div class='form-group'>
								<label>Categoria</label>
								<select class='form-control' ng-model='article.filter.category' ng-options='category.id as category.name for category in article.categories' />
							</div>
						</div>
						<div class='col-md-3'>
							<div class='form-group'>
								<label>Revista</label>
								<input type='text' ng-model='article.filter.magazine' typeahead='magazine.name for magazine in article.magazines | filter:$viewValue | limitTo:8' class='form-control'>
							</div>
						</div>
						<div class='col-md-3'>
							<div class='form-group'>
								<label>&nbsp;</label>
								<div>
									<div class='checkbox'>
										<label>
											<input ng-model='article.filter.onlyWithoutCover' type='checkbox'> Apenas artigos sem capa
										</label>
									</div>
								</div>
							</div>
						</div>
					</div>
				</form>

				<hr ng-if='article.articles' />

				<div class='row' ng-if='article.articles'>
					<div class='col-md-12'>
						<div class='table-responsive'>
							<table st-table='article.articlesList' st-safe-src='article.articles' class='table table-striped table-hover'>
								<thead>
									<tr>
										<th colspan='5'>
											<input st-search='' st-delay='0' class='form-control' placeholder='Pesquisar' type='text' style='width: 300px' />
										</th>
										<th colspan='2'>
											<button class='btn btn-default pull-right' type='submit' ng-click='article.articles = null'>
												<i class='fa fa-clear'></i> Limpar resultados
											</button>
										</th>
										<!--<th colspan='2' width='50px'>
											<button class='btn btn-primary pull-right' ng-click='user.prepareCreate()'>
												<i class='fa fa-plus'></i><span class='hidden-xs'> Novas Capas</span>
											</button>
										</th>-->
									</tr>
									<tr>
										<th class='cover-list'>Capa</th>
										<th width='20%'>Revista</th>
										<th>Artigo</th>
										<th>Autores</th>
										<th width="50px">Edição</th>
										<th width='50px'></th>
										<th width='50px'></th>
									</tr>
								</thead>
								<tbody>
									<tr ng-repeat='a in article.articlesList'>
										<td>
											<a href ng-click='article.showDetails(a)'>
												<img class='cover-list' ng-src='{{a.cover}}'>
											</a>
										</td>
										<td>{{a.magazine}}</td>
										<td>{{a.article}}</td>
										<td>
											<span>
												<span ng-repeat='a in a.authors'>{{a}}<span ng-if='!$last'>, </span></span>
											</span>
										</td>
										<td>{{a.edition}}</td>
										<td>
											<button class='btn btn-default pull-right' ng-click='article.edit(a)'>
												<i class='fa fa-pencil'></i><span class='hidden-xs'> Editar</span>
											</button>
										</td>
										<td>
											<button class='btn btn-default pull-right' ng-click='article.remove(a)'>
												<i class='fa fa-close'></i><span class='hidden-xs'> Remover</span>
											</button>
										</td>
									</tr>
									<tr ng-if='article.articlesList.length === 0' style='height: 51px;'>
										<td colspan='7'>
											Nenhum resultado encontrado.
										</td>
									</tr>
								</tbody>
								<tfoot>
									<tr>
										<td colspan='7' class='text-center'>
											<div st-pagination='' st-items-by-page='10' st-displayed-pages='7'></div>
										</td>
									</tr>
								</tfoot>
							</table>
						</div>
					</div>
				</div>
			</div>
		</div>
	</div>
</div>

<script type='text/ng-template' id='details-dialog'>
	<br />

	<div class='text-center'>
		<img ng-src="{{article.currentArticle.cover}}" />
	</div>

	<div class='row'>
		<div class='col-md-12'>
			<h3>{{article.currentArticle.article}}</h3>
			<h4>{{article.currentArticle.magazine}}</h4>
			<p>
				<span>
					<span ng-repeat="a in article.currentArticle.authors">{{a}}<span ng-if="!$last">, </span></span>
				</span>
			</p>
			<p ng-if='article.currentArticle.edition'>
				<span>{{article.currentArticle.edition}} edição</span>
			</p>
			<small>Imagem carregada por <b>Usuário 1</b> no dia <b>20/04/2015</b>.</small>
		</div>
	</div>
</script>